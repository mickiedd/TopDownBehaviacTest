<?xml version="1.0" encoding="utf-8"?>
<!--
  PenguinWanderTree.xml  (refactored)
  Behaviac behavior tree for ABehaviacPenguin / BP_Penguin.

  Architecture: BT XML owns ALL decisions and sequencing.
  C++ / BehaviacPenguin only implements leaf actions.

  Mood system (set each cycle by RollMood):
    MoodRoll float on blackboard, range [0, 1)
    < 0.35  → Sleepy   (short shuffle, long nap)
    < 0.70  → Curious  (normal wander, look around twice)
    else    → Excited  (fast run, spin + jump on arrival)

  Loop forever via DecoratorLoop Count=-1.
-->
<behavior version="1" agenttype="ABehaviacPenguin">

  <!-- Outer loop: repeat forever -->
  <node class="DecoratorLoop" id="1">
    <property name="Count" value="-1"/>

    <node class="Sequence" id="2">

      <!-- 1. Roll a new mood for this cycle -->
      <node class="Action" id="3">
        <property name="Method" value="RollMood"/>
      </node>

      <!-- 2. Pick a wander target (all moods need a destination) -->
      <node class="Action" id="4">
        <property name="Method" value="PickWanderTarget"/>
      </node>

      <!--
        3. Mood selector — tries branches top-to-bottom.
           Each branch is guarded by a Condition on MoodRoll.
      -->
      <node class="Selector" id="5">

        <!-- ── SLEEPY branch (MoodRoll < 0.35) ─────────────────── -->
        <node class="Sequence" id="10">
          <node class="Condition" id="11">
            <property name="Opl" value="MoodRoll"/>
            <property name="Operator" value="Less"/>
            <property name="Opr" value="0.35"/>
          </node>
          <!-- Shuffle slowly to target -->
          <node class="Action" id="12">
            <property name="Method" value="SetSleepySpeed"/>
          </node>
          <node class="Action" id="13">
            <property name="Method" value="MoveToWanderTarget"/>
          </node>
          <node class="Action" id="14">
            <property name="Method" value="StopMovement"/>
          </node>
          <!-- Drowsy look-around, slow -->
          <node class="Action" id="15">
            <property name="Method" value="LookAround"/>
          </node>
          <!-- Long nap -->
          <node class="Wait" id="16">
            <property name="Time" value="5.0"/>
          </node>
          <!-- Occasionally do a half-asleep random spin before waking -->
          <node class="DecoratorAlwaysSuccess" id="17">
            <node class="Action" id="18">
              <property name="Method" value="MaybeSpin"/>
            </node>
          </node>
        </node>
        <!-- end Sleepy -->

        <!-- ── CURIOUS branch (MoodRoll < 0.70) ────────────────── -->
        <node class="Sequence" id="20">
          <node class="Condition" id="21">
            <property name="Opl" value="MoodRoll"/>
            <property name="Operator" value="Less"/>
            <property name="Opr" value="0.70"/>
          </node>
          <!-- Normal walk speed -->
          <node class="Action" id="22">
            <property name="Method" value="SetWanderSpeed"/>
          </node>
          <node class="Action" id="23">
            <property name="Method" value="MoveToWanderTarget"/>
          </node>
          <node class="Action" id="24">
            <property name="Method" value="StopMovement"/>
          </node>
          <!-- Short pause -->
          <node class="Wait" id="25">
            <property name="Time" value="1.0"/>
          </node>
          <!-- Look around once -->
          <node class="Action" id="26">
            <property name="Method" value="LookAround"/>
          </node>
          <!-- Look around a second time (curious!) -->
          <node class="Action" id="27">
            <property name="Method" value="LookAround"/>
          </node>
          <!-- Rest before next cycle -->
          <node class="Wait" id="28">
            <property name="Time" value="2.0"/>
          </node>
        </node>
        <!-- end Curious -->

        <!-- ── EXCITED branch (MoodRoll >= 0.70) ───────────────── -->
        <node class="Sequence" id="30">
          <!-- No condition needed — Selector fallthrough guarantees MoodRoll >= 0.70 -->
          <!-- Sprint! -->
          <node class="Action" id="31">
            <property name="Method" value="SetExcitedSpeed"/>
          </node>
          <node class="Action" id="32">
            <property name="Method" value="MoveToWanderTarget"/>
          </node>
          <node class="Action" id="33">
            <property name="Method" value="StopMovement"/>
          </node>
          <!-- Celebratory spin on arrival -->
          <node class="Action" id="34">
            <property name="Method" value="SpinAround"/>
          </node>
          <!-- Excited jump -->
          <node class="Action" id="35">
            <property name="Method" value="ExcitedJump"/>
          </node>
          <!-- Brief panting rest -->
          <node class="Wait" id="36">
            <property name="Time" value="1.5"/>
          </node>
          <!-- Maybe one more spin because why not -->
          <node class="DecoratorAlwaysSuccess" id="37">
            <node class="Action" id="38">
              <property name="Method" value="MaybeSpin"/>
            </node>
          </node>
        </node>
        <!-- end Excited -->

      </node>
      <!-- end Selector -->

    </node>
    <!-- end outer Sequence -->

  </node>
  <!-- end DecoratorLoop -->

</behavior>
